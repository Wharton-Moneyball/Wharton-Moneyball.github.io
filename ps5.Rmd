---
title: "Problem Set 5"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Recreate a Graph

There are many types of visualizations you can explore with ggplot. Sometimes the most difficult part is choosing the type of graph and designing a layout that will best communicate your thoughts. A great place to find inspiration is by looking at visualizations from other sources.

For instance, we heard from Neil Paine earlier this week. Neil is a writer for Five Thirty Eight, a leader in "data journalism" for sports and politics. Many organizations like these have seperate teams of visualization experts who work on designing and coding graphics for popular articles. 

Let's try to recreate one of Neil's graphics from his article on the top fight songs of college teams. Start by reading Neil's [original article](https://projects.fivethirtyeight.com/college-fight-song-lyrics/). Then, download the data file used to make this article from its [GitHub page](https://github.com/fivethirtyeight/data/tree/master/fight-songs)

```{r second, message=TRUE, warning=TRUE}
file_from_git<-'https://raw.githubusercontent.com/fivethirtyeight/data/master/fight-songs/fight-songs.csv'
data<-read.csv(file_from_git)

```



The data contains information on fight songs from all schools in the ACC, the Big Ten, the Big 12, Pac-12, and SEC, plus Notre Dame. Start by inspecting the structure of the dataset using the str() function. It is important to identify the "type of each variable as you create graphics. In this case, the two variables that we will be using as the x and the y axis , the duration and bpm, are already identified as integer variables.


```{r second2, message=TRUE, warning=TRUE}
str(data)
```

To visualize the data, use a geom point and place your x and y axes on the graph. 


```{r second3, message=TRUE, warning=TRUE}
library(ggplot2)
ggplot(data, aes(x = sec_duration, y = bpm)) +
  geom_point()

```

Next, color by school name.

```{r second4, message=TRUE, warning=TRUE}
library(ggplot2)
ggplot(data, aes(x = sec_duration, y = bpm, color = school)) +
  geom_point() +
  theme(legend.position = "none")

```

Use ggplot arguments to make the following changes to the graph to recreate Neil's original graph:

1. Use alpha and size arguments to match the original graph.
2. Add a title, x label, and y label that match the labels on the original graph
4. Add a black point to the graph to mark Notre Dame
5. Label the Notre Dame point with text
6. Use geom_vline and geom_hline to create an axis at the x and y intercept for the averages

## Make it Interactive

A big goal of data visualization right now is to make charts interactive. Plotly in R is one way to begin to make your graphics interactive. Once you have your graph saved as a new object, install the plotly package and run the functin (ggplotly) on the graph in order to add interactive elements.

```{r second5, eval=FALSE, message=TRUE, warning=TRUE, include=FALSE}
#install.packages(plotly)
library(plotly)
ggplotly(name_of_completed_graph)

```

```{r third, echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
notredame <- data %>%
  filter(school == "Notre Dame")
library(plotly)
n <- ggplot(data = data, aes(x = sec_duration, y = bpm, color = school)) +
  geom_point(size = 4, alpha = .4) +
  geom_hline(yintercept = mean(data$bpm), linetype = "dashed") +
  geom_vline(xintercept =  mean(data$sec_duration), linetype = "dashed") +
  geom_point(data = notredame, aes(x = sec_duration, y = bpm), color = 'black',
             size = 6) +
  geom_text(aes(label = ifelse(school == "Notre Dame", as.character(school), ''),
                hjust = .2, vjust = -2)) +
  labs(title = "How Notre Dame's fight song stacks up") +
  xlab("Duration") +
  ylab("Beats per Minute") +
  theme(legend.position = "none") +
  theme(plot.title = element_text(family = "Helvetica",
                                  face = "bold",
                                  size = (15))) 
ggplotly(n)
```


## Work with New Data


Choose from the plots on Five Thirty Eight and recreate a graph using ggplot. Try to match the style and format of the graph, or use new tools like plotly to make the graph interactice.

You can find data and code behind some of the articles [here](https://data.fivethirtyeight.com/). 
