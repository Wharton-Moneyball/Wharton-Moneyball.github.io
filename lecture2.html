<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Lecture 2: Visualization and More Data Wrangling</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">WMA2020</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-futbol-o"></span>
     
    Lecture Notes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="lecture1.html">Lecture 1</a>
    </li>
    <li>
      <a href="lecture2.html">Lecture 2</a>
    </li>
    <li>
      <a href="lecture3.html">Lecture 3</a>
    </li>
    <li>
      <a href="lecture4.html">Lecture 4</a>
    </li>
    <li>
      <a href="lecture5.html">Lecture 5</a>
    </li>
    <li>
      <a href="lecture6.html">Lecture 6</a>
    </li>
    <li>
      <a href="lecture7.html">Lecture 7</a>
    </li>
    <li>
      <a href="lecture8.html">Lecture 8</a>
    </li>
    <li>
      <a href="nfl_lecture.html">nflscrapR lecture</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-dribbble"></span>
     
    Problem Sets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="ps0.html">Problem Set 0</a>
    </li>
    <li>
      <a href="ps1.html">Problem Set 1</a>
    </li>
    <li>
      <a href="ps2.html">Problem Set 2</a>
    </li>
    <li>
      <a href="ps3.html">Problem Set 3</a>
    </li>
    <li>
      <a href="ps4.html">Problem Set 4</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-bar-chart"></span>
     
    Training Camp
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="install_setup.html">Installation</a>
    </li>
    <li>
      <a href="tc_lecture1.html">Lecture 1</a>
    </li>
    <li>
      <a href="tc_ps1.html">Problem Set 1</a>
    </li>
    <li>
      <a href="tc_lecture2.html">Lecture 2</a>
    </li>
    <li>
      <a href="tc_ps2.html">Problem Set 2</a>
    </li>
    <li>
      <a href="tc_lecture3.html">Lecture 3</a>
    </li>
    <li>
      <a href="tc_ps3.html">Problem Set 3</a>
    </li>
    <li>
      <a href="tc_lecture4.html">Lecture 4</a>
    </li>
    <li>
      <a href="tc_lecture5.html">Lecture 5</a>
    </li>
    <li>
      <a href="more_resources.html">More resources</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Lecture 2: Visualization and More Data Wrangling</h1>

</div>


<p>We’re going to pick up right where we left off yesterday in <a href="ps1.html">Problem Set 1</a>, where you wrote a script to create a tbl containg several shooting statistics for NBA players between the 1996-97 season and the 2015-16 season. Your script should look something like what is the code block below. For reasons that will become clear shortly, we are going to call our tbl <code>raw_shooting</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="op">&gt;</span><span class="st"> </span>raw_shooting &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="dt">file =</span> <span class="st">&quot;data/nba_shooting.csv&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a>Parsed with column specification<span class="op">:</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">cols</span>(</span>
<span id="cb1-5"><a href="#cb1-5"></a>  <span class="dt">PLAYER =</span> <span class="kw">col_character</span>(),</span>
<span id="cb1-6"><a href="#cb1-6"></a>  <span class="dt">SEASON =</span> <span class="kw">col_double</span>(),</span>
<span id="cb1-7"><a href="#cb1-7"></a>  <span class="dt">FGM =</span> <span class="kw">col_double</span>(),</span>
<span id="cb1-8"><a href="#cb1-8"></a>  <span class="dt">FGA =</span> <span class="kw">col_double</span>(),</span>
<span id="cb1-9"><a href="#cb1-9"></a>  <span class="dt">TPM =</span> <span class="kw">col_double</span>(),</span>
<span id="cb1-10"><a href="#cb1-10"></a>  <span class="dt">TPA =</span> <span class="kw">col_double</span>(),</span>
<span id="cb1-11"><a href="#cb1-11"></a>  <span class="dt">FTM =</span> <span class="kw">col_double</span>(),</span>
<span id="cb1-12"><a href="#cb1-12"></a>  <span class="dt">FTA =</span> <span class="kw">col_double</span>()</span>
<span id="cb1-13"><a href="#cb1-13"></a>)</span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="op">&gt;</span><span class="st"> </span>raw_shooting &lt;-</span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="op">+</span><span class="st">   </span><span class="kw">mutate</span>(raw_shooting,</span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="op">+</span><span class="st">          </span><span class="dt">FGP =</span> FGM<span class="op">/</span>FGA,</span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="op">+</span><span class="st">          </span><span class="dt">TPP =</span> TPM<span class="op">/</span>TPA,</span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="op">+</span><span class="st">          </span><span class="dt">FTP =</span> FTM<span class="op">/</span>FTA,</span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="op">+</span><span class="st">          </span><span class="dt">eFGP =</span> (FGM <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>TPM)<span class="op">/</span>(FGA),</span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="op">+</span><span class="st">          </span><span class="dt">PTS =</span> FTM <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>FGM <span class="op">+</span><span class="st"> </span>TPM,</span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="op">+</span><span class="st">          </span><span class="dt">TSP =</span> PTS<span class="op">/</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(FGA <span class="op">+</span><span class="st"> </span><span class="fl">0.44</span> <span class="op">*</span><span class="st"> </span>FTA)))</span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="op">&gt;</span><span class="st"> </span>nba_shooting &lt;-<span class="st"> </span><span class="kw">arrange</span>(raw_shooting, <span class="kw">desc</span>(TSP))</span></code></pre></div>
<p>We will use visualization to answer some questions about the data. Specifically, we will study the distribution of the individual columns as well as try to understand the relationship between pairs of variables. For instance, is a player’s free throw percentage predictive of his three point percentage?</p>
<p>To produce graphics throughout this course, we will use ggplot2, which is a package contained in the tidyverse. At a very high level, ggplot2 works by layering graphics, adding different features one on top of another. You can learn much much more about ggplot2 <a href="https://ggplot2.tidyverse.org">here</a>. We will cover some of the more advanced functionality of ggplot2 in</p>
<div id="histograms" class="section level3">
<h3>Histograms</h3>
<p>As you saw in Prof. Wyner’s lectures, histograms are a powerful way to describe a single dataset.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> raw_shooting) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="op">+</span><span class="st">   </span><span class="kw">geom_histogram</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> FGP), <span class="dt">bins =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="lecture2_files/figure-html/fgp-histogram-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The first bit of the code above, <code>ggplot(data = nba_shooting)</code> tells R to create a coordinate system to which can add additional layers. It also tells R that the data to be plotted is coming from the tibble <code>nba_shooting</code>. The next part of the code, <code>+ geom_histogram(mapping = aes(FGP), bins = 5)</code> tells R to <em>add</em> a layer to the blank plot, in this case a histogram of field goal percentage that uses 5 bins. The first argument is the mapping, which defines how each variable in our dataset is mapped to visual components of the graph (the <em>aesthetics</em>) In the case of a histogram, we really only need to tell R that the variable we want to visualize goes on the horizontal (x) axis. To improve readability, we have divided the code to produce the historgram over two lines. <strong>It is very important when using ggplot to have the + sign at the end of the line.</strong></p>
<p>In the code above, we also told R how many bins into which to divide the data. We can vary the number of bins to get a higher-resolution view of our data. For instance, we can use 50 bins: <img src="lecture2_files/figure-html/unnamed-chunk-1-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Instead of specifying the number of bins, which can sometimes be difficult, we could instead specify the width of the bins. For instance, we could split our data into bins of width 0.05 as follows:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> raw_shooting) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> FGP), <span class="dt">binwidth =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<p><img src="lecture2_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>It is often preferable to use a density histogram instead of a frequency histogram. This is because the areas of the density histogram boxes always sums to 1 no matter how much data you have.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> raw_shooting) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> FGP, <span class="dt">y =</span> ..density..), <span class="dt">bins =</span> <span class="dv">50</span>)</span></code></pre></div>
<p><img src="lecture2_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /> Visually, the histograms look identical but now the vertical (y) axis has a different scale.</p>
<!--**Exercise** Make histograms of FGA, FTA, TPA, FTP, and TPP. Comment on the differences-->
</div>
<div id="visualizing-bivariate-data" class="section level3">
<h3>Visualizing bivariate data</h3>
<p>While examining one variable (i.e. column of our data table) is useful, we are often more interested in understanding the relationships between multiple variables. For instance, how do you think a player’s free throw percentage (FTP) is related to his field goal percentage (FGP)?</p>
<p>To make a scatterplot in R, we can run the following code. Notice that it is very similar to the code used to make histograms, but with a few important differences</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> raw_shooting) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> FGP, <span class="dt">y =</span> FTP))</span></code></pre></div>
<p><img src="lecture2_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Just like the code used to produce the histograms above, we began by calling <code>ggplot(data = nba_shooting)</code>. Now, however, instead of calling <code>geom_histogram()</code> we are calling <code>geom_point()</code>. This tells R that instead of a histogram, we want to plot the data using points. We will learn much more about the different “geom” objects available in ggplot2 in Lecture 4. Since we are plotting multiple variables, we need to tell R to which axis each variable is mapped. This is exactly what<code>mapping = aes(x = FGP, y = FTP)</code> does.</p>
<p>Immediately, we notice a few things about the figure. First, we see what appears to be a big black cloud of points in the middle of the plotting region. This is a result of R trying to plot lots and lots of data points in a small region of the plane. Additionally, we find a few rather interesting data points, corresponding to players who have never made a field goal but are perfect free throw shooters and to players who have never missed a field goal but have made only 50% of their free throws. A major drawback of this scatterplot is its inability to show the relative density of points. That is, does the point at (1.00, 0.50) correspond to a single player or does it correspond to multiple ones?</p>
<p>One way to address this is to use <em>alpha-blending</em> to change the transparency of each point. When there are many points plotted in the same region, that region will appear darker.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> raw_shooting) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> FGP, <span class="dt">y =</span> FTP), <span class="dt">alpha =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="lecture2_files/figure-html/scatterplot-alpha-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Now we can start to distinguish the number of players represented by each point. The fact that the point at (0.00, 0.50) is much darker than the point at (0.00, 1.00) indicates that there are more players who missed every one of their field goal attempts and made 50% of their free throws than players who missed every field goal but made every free throw.</p>
<p>To get an even better idea, we can make a <em>heatmap</em>, which you can think of as a two-dimensional analog of a histogram. To form a heatmap, you start by dividing the plane into lots of evenly-sized two-dimensional bins and counting the number of datapoints within each bin. You then color the bin according to the count. While you can conceptually make the bins any shape you want, there are two popular conventions: rectangular binning and hexagonal binning. For the purposes of this course, we will focus on rectangular binning, using the <code>geom_bin2d()</code> function.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> raw_shooting) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bin2d</span>(<span class="kw">aes</span>(<span class="dt">x =</span> FGP, <span class="dt">y =</span> FTP))</span></code></pre></div>
<p><img src="lecture2_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We can increase the number of bins to get a much more high-resolution view of our data.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> raw_shooting) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bin2d</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> FGP, <span class="dt">y =</span> FTP), <span class="dt">bins =</span> <span class="dv">100</span>)</span></code></pre></div>
<p><img src="lecture2_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Now we are starting to get some sense that there are some outliers in our data. We can confirm this visually in another way</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> raw_shooting) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> FGA, <span class="dt">y =</span> FGP), <span class="dt">alpha =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="lecture2_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Sometimes, we don’t want to look at the entire range of the data and only want to plot a smaller window. We can do this by changing the x and y limits of the plotting region</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> raw_shooting) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> FGA, <span class="dt">y =</span> FGP)) <span class="op">+</span><span class="st"> </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="dv">200</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>Warning<span class="op">:</span><span class="st"> </span>Removed <span class="dv">5346</span> rows containing missing <span class="kw">values</span> (geom_point).</span></code></pre></div>
<p><img src="lecture2_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="filtering" class="section level2">
<h2>Filtering</h2>
<p>By this point, it should be clear that there are a number of rather curious features in our dataset. For instance, there seem to be several players who have never made a field goal but have made every one of their free throw attempts. After re-arranging our tbl according to the number of field goals made, it is clear that we have several players who have attempted fewer than 5 field goals in a single season. Before examining the relationship between a player’s field goal percentage and free throw percentage, we’d like to remove all of the players who have not attempted many of each type of shot.</p>
<p>The function <code>filter()</code> is used to pull out subsets of observations that satisfy some logical condition like “FGA &gt; 100” or “FGA &gt; 100 and FTA &gt; 50”. To make such comparisons in R, we have the following operators available at our disposal:</p>
<ul>
<li><code>==</code> for “equal to”</li>
<li><code>!=</code> for “not equal to”</li>
<li><code>&lt;</code> and <code>&lt;=</code> for “less than” and “less than or equal to”</li>
<li><code>&gt;</code> and <code>&gt;=</code> for “greater than” and “greater than or equal to”</li>
<li><code>&amp;</code>, <code>|</code>, <code>!</code> for “AND” and “OR” and “NOT” The code below filter out all of the players with at least 100 field goals in a single season</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">filter</span>(raw_shooting, FGA <span class="op">&gt;</span><span class="st"> </span><span class="dv">100</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co"># A tibble: 6,295 x 14</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>   PLAYER            SEASON   FGM   FGA   TPM   TPA   FTM   FTA   FGP   TPP   FTP  eFGP   PTS   TSP</span>
<span id="cb11-4"><a href="#cb11-4"></a>   <span class="op">&lt;</span>chr<span class="op">&gt;</span><span class="st">              </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="st"> </span><span class="dv">1</span> Stephen Curry       <span class="dv">2016</span>   <span class="dv">805</span>  <span class="dv">1597</span>   <span class="dv">402</span>   <span class="dv">887</span>   <span class="dv">363</span>   <span class="dv">400</span> <span class="fl">0.504</span> <span class="fl">0.453</span> <span class="fl">0.908</span> <span class="fl">0.630</span>  <span class="dv">2375</span> <span class="fl">0.670</span></span>
<span id="cb11-6"><a href="#cb11-6"></a> <span class="dv">2</span> James Harden        <span class="dv">2016</span>   <span class="dv">710</span>  <span class="dv">1617</span>   <span class="dv">236</span>   <span class="dv">657</span>   <span class="dv">720</span>   <span class="dv">837</span> <span class="fl">0.439</span> <span class="fl">0.359</span> <span class="fl">0.860</span> <span class="fl">0.512</span>  <span class="dv">2376</span> <span class="fl">0.598</span></span>
<span id="cb11-7"><a href="#cb11-7"></a> <span class="dv">3</span> Kevin Durant        <span class="dv">2016</span>   <span class="dv">698</span>  <span class="dv">1381</span>   <span class="dv">186</span>   <span class="dv">480</span>   <span class="dv">447</span>   <span class="dv">498</span> <span class="fl">0.505</span> <span class="fl">0.388</span> <span class="fl">0.898</span> <span class="fl">0.573</span>  <span class="dv">2029</span> <span class="fl">0.634</span></span>
<span id="cb11-8"><a href="#cb11-8"></a> <span class="dv">4</span> DeMarcus Cousins    <span class="dv">2016</span>   <span class="dv">601</span>  <span class="dv">1332</span>    <span class="dv">70</span>   <span class="dv">210</span>   <span class="dv">476</span>   <span class="dv">663</span> <span class="fl">0.451</span> <span class="fl">0.333</span> <span class="fl">0.718</span> <span class="fl">0.477</span>  <span class="dv">1748</span> <span class="fl">0.538</span></span>
<span id="cb11-9"><a href="#cb11-9"></a> <span class="dv">5</span> LeBron James        <span class="dv">2016</span>   <span class="dv">737</span>  <span class="dv">1416</span>    <span class="dv">87</span>   <span class="dv">282</span>   <span class="dv">359</span>   <span class="dv">491</span> <span class="fl">0.520</span> <span class="fl">0.309</span> <span class="fl">0.731</span> <span class="fl">0.551</span>  <span class="dv">1920</span> <span class="fl">0.588</span></span>
<span id="cb11-10"><a href="#cb11-10"></a> <span class="dv">6</span> Damian Lillard      <span class="dv">2016</span>   <span class="dv">618</span>  <span class="dv">1474</span>   <span class="dv">229</span>   <span class="dv">610</span>   <span class="dv">414</span>   <span class="dv">464</span> <span class="fl">0.419</span> <span class="fl">0.375</span> <span class="fl">0.892</span> <span class="fl">0.497</span>  <span class="dv">1879</span> <span class="fl">0.560</span></span>
<span id="cb11-11"><a href="#cb11-11"></a> <span class="dv">7</span> Anthony Davis       <span class="dv">2016</span>   <span class="dv">560</span>  <span class="dv">1137</span>    <span class="dv">35</span>   <span class="dv">108</span>   <span class="dv">326</span>   <span class="dv">430</span> <span class="fl">0.493</span> <span class="fl">0.324</span> <span class="fl">0.758</span> <span class="fl">0.508</span>  <span class="dv">1481</span> <span class="fl">0.558</span></span>
<span id="cb11-12"><a href="#cb11-12"></a> <span class="dv">8</span> Russell Westbrook   <span class="dv">2016</span>   <span class="dv">656</span>  <span class="dv">1444</span>   <span class="dv">101</span>   <span class="dv">341</span>   <span class="dv">465</span>   <span class="dv">573</span> <span class="fl">0.454</span> <span class="fl">0.296</span> <span class="fl">0.812</span> <span class="fl">0.489</span>  <span class="dv">1878</span> <span class="fl">0.554</span></span>
<span id="cb11-13"><a href="#cb11-13"></a> <span class="dv">9</span> DeMar DeRozan       <span class="dv">2016</span>   <span class="dv">614</span>  <span class="dv">1377</span>    <span class="dv">47</span>   <span class="dv">139</span>   <span class="dv">555</span>   <span class="dv">653</span> <span class="fl">0.446</span> <span class="fl">0.338</span> <span class="fl">0.850</span> <span class="fl">0.463</span>  <span class="dv">1830</span> <span class="fl">0.550</span></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="dv">10</span> Paul George         <span class="dv">2016</span>   <span class="dv">605</span>  <span class="dv">1448</span>   <span class="dv">210</span>   <span class="dv">565</span>   <span class="dv">454</span>   <span class="dv">528</span> <span class="fl">0.418</span> <span class="fl">0.372</span> <span class="fl">0.860</span> <span class="fl">0.490</span>  <span class="dv">1874</span> <span class="fl">0.558</span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co"># … with 6,285 more rows</span></span></code></pre></div>
<p>When we run this code, you’ll notice that R prints out a tbl with 6,295 rows.</p>
<p>We can also filter on more complicated conditions constructed using the AND, OR, and NOT operators: <code>&amp;</code>, <code>|</code>, and <code>!</code>. For instance, to filter observations with at least 100 field goal attempts OR 50 three point attempts, we would do</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">filter</span>(raw_shooting, FGA <span class="op">&gt;=</span><span class="st"> </span><span class="dv">100</span> <span class="op">|</span><span class="st"> </span>TPA <span class="op">&gt;=</span><span class="st"> </span><span class="dv">50</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="co"># A tibble: 6,328 x 14</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>   PLAYER            SEASON   FGM   FGA   TPM   TPA   FTM   FTA   FGP   TPP   FTP  eFGP   PTS   TSP</span>
<span id="cb12-4"><a href="#cb12-4"></a>   <span class="op">&lt;</span>chr<span class="op">&gt;</span><span class="st">              </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="st"> </span><span class="dv">1</span> Stephen Curry       <span class="dv">2016</span>   <span class="dv">805</span>  <span class="dv">1597</span>   <span class="dv">402</span>   <span class="dv">887</span>   <span class="dv">363</span>   <span class="dv">400</span> <span class="fl">0.504</span> <span class="fl">0.453</span> <span class="fl">0.908</span> <span class="fl">0.630</span>  <span class="dv">2375</span> <span class="fl">0.670</span></span>
<span id="cb12-6"><a href="#cb12-6"></a> <span class="dv">2</span> James Harden        <span class="dv">2016</span>   <span class="dv">710</span>  <span class="dv">1617</span>   <span class="dv">236</span>   <span class="dv">657</span>   <span class="dv">720</span>   <span class="dv">837</span> <span class="fl">0.439</span> <span class="fl">0.359</span> <span class="fl">0.860</span> <span class="fl">0.512</span>  <span class="dv">2376</span> <span class="fl">0.598</span></span>
<span id="cb12-7"><a href="#cb12-7"></a> <span class="dv">3</span> Kevin Durant        <span class="dv">2016</span>   <span class="dv">698</span>  <span class="dv">1381</span>   <span class="dv">186</span>   <span class="dv">480</span>   <span class="dv">447</span>   <span class="dv">498</span> <span class="fl">0.505</span> <span class="fl">0.388</span> <span class="fl">0.898</span> <span class="fl">0.573</span>  <span class="dv">2029</span> <span class="fl">0.634</span></span>
<span id="cb12-8"><a href="#cb12-8"></a> <span class="dv">4</span> DeMarcus Cousins    <span class="dv">2016</span>   <span class="dv">601</span>  <span class="dv">1332</span>    <span class="dv">70</span>   <span class="dv">210</span>   <span class="dv">476</span>   <span class="dv">663</span> <span class="fl">0.451</span> <span class="fl">0.333</span> <span class="fl">0.718</span> <span class="fl">0.477</span>  <span class="dv">1748</span> <span class="fl">0.538</span></span>
<span id="cb12-9"><a href="#cb12-9"></a> <span class="dv">5</span> LeBron James        <span class="dv">2016</span>   <span class="dv">737</span>  <span class="dv">1416</span>    <span class="dv">87</span>   <span class="dv">282</span>   <span class="dv">359</span>   <span class="dv">491</span> <span class="fl">0.520</span> <span class="fl">0.309</span> <span class="fl">0.731</span> <span class="fl">0.551</span>  <span class="dv">1920</span> <span class="fl">0.588</span></span>
<span id="cb12-10"><a href="#cb12-10"></a> <span class="dv">6</span> Damian Lillard      <span class="dv">2016</span>   <span class="dv">618</span>  <span class="dv">1474</span>   <span class="dv">229</span>   <span class="dv">610</span>   <span class="dv">414</span>   <span class="dv">464</span> <span class="fl">0.419</span> <span class="fl">0.375</span> <span class="fl">0.892</span> <span class="fl">0.497</span>  <span class="dv">1879</span> <span class="fl">0.560</span></span>
<span id="cb12-11"><a href="#cb12-11"></a> <span class="dv">7</span> Anthony Davis       <span class="dv">2016</span>   <span class="dv">560</span>  <span class="dv">1137</span>    <span class="dv">35</span>   <span class="dv">108</span>   <span class="dv">326</span>   <span class="dv">430</span> <span class="fl">0.493</span> <span class="fl">0.324</span> <span class="fl">0.758</span> <span class="fl">0.508</span>  <span class="dv">1481</span> <span class="fl">0.558</span></span>
<span id="cb12-12"><a href="#cb12-12"></a> <span class="dv">8</span> Russell Westbrook   <span class="dv">2016</span>   <span class="dv">656</span>  <span class="dv">1444</span>   <span class="dv">101</span>   <span class="dv">341</span>   <span class="dv">465</span>   <span class="dv">573</span> <span class="fl">0.454</span> <span class="fl">0.296</span> <span class="fl">0.812</span> <span class="fl">0.489</span>  <span class="dv">1878</span> <span class="fl">0.554</span></span>
<span id="cb12-13"><a href="#cb12-13"></a> <span class="dv">9</span> DeMar DeRozan       <span class="dv">2016</span>   <span class="dv">614</span>  <span class="dv">1377</span>    <span class="dv">47</span>   <span class="dv">139</span>   <span class="dv">555</span>   <span class="dv">653</span> <span class="fl">0.446</span> <span class="fl">0.338</span> <span class="fl">0.850</span> <span class="fl">0.463</span>  <span class="dv">1830</span> <span class="fl">0.550</span></span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="dv">10</span> Paul George         <span class="dv">2016</span>   <span class="dv">605</span>  <span class="dv">1448</span>   <span class="dv">210</span>   <span class="dv">565</span>   <span class="dv">454</span>   <span class="dv">528</span> <span class="fl">0.418</span> <span class="fl">0.372</span> <span class="fl">0.860</span> <span class="fl">0.490</span>  <span class="dv">1874</span> <span class="fl">0.558</span></span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="co"># … with 6,318 more rows</span></span></code></pre></div>
<p>We may combine these constraints by enclosing them in parantheses.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">filter</span>(raw_shooting, (FGA <span class="op">&gt;=</span><span class="st"> </span><span class="dv">100</span> <span class="op">&amp;</span><span class="st"> </span>TPA <span class="op">&gt;=</span><span class="st"> </span><span class="dv">50</span>) <span class="op">|</span><span class="st"> </span>(FGP <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.45</span> <span class="op">&amp;</span><span class="st"> </span>FGP <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.5</span>))</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co"># A tibble: 4,837 x 14</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>   PLAYER            SEASON   FGM   FGA   TPM   TPA   FTM   FTA   FGP   TPP   FTP  eFGP   PTS   TSP</span>
<span id="cb13-4"><a href="#cb13-4"></a>   <span class="op">&lt;</span>chr<span class="op">&gt;</span><span class="st">              </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="st"> </span><span class="dv">1</span> Stephen Curry       <span class="dv">2016</span>   <span class="dv">805</span>  <span class="dv">1597</span>   <span class="dv">402</span>   <span class="dv">887</span>   <span class="dv">363</span>   <span class="dv">400</span> <span class="fl">0.504</span> <span class="fl">0.453</span> <span class="fl">0.908</span> <span class="fl">0.630</span>  <span class="dv">2375</span> <span class="fl">0.670</span></span>
<span id="cb13-6"><a href="#cb13-6"></a> <span class="dv">2</span> James Harden        <span class="dv">2016</span>   <span class="dv">710</span>  <span class="dv">1617</span>   <span class="dv">236</span>   <span class="dv">657</span>   <span class="dv">720</span>   <span class="dv">837</span> <span class="fl">0.439</span> <span class="fl">0.359</span> <span class="fl">0.860</span> <span class="fl">0.512</span>  <span class="dv">2376</span> <span class="fl">0.598</span></span>
<span id="cb13-7"><a href="#cb13-7"></a> <span class="dv">3</span> Kevin Durant        <span class="dv">2016</span>   <span class="dv">698</span>  <span class="dv">1381</span>   <span class="dv">186</span>   <span class="dv">480</span>   <span class="dv">447</span>   <span class="dv">498</span> <span class="fl">0.505</span> <span class="fl">0.388</span> <span class="fl">0.898</span> <span class="fl">0.573</span>  <span class="dv">2029</span> <span class="fl">0.634</span></span>
<span id="cb13-8"><a href="#cb13-8"></a> <span class="dv">4</span> DeMarcus Cousins    <span class="dv">2016</span>   <span class="dv">601</span>  <span class="dv">1332</span>    <span class="dv">70</span>   <span class="dv">210</span>   <span class="dv">476</span>   <span class="dv">663</span> <span class="fl">0.451</span> <span class="fl">0.333</span> <span class="fl">0.718</span> <span class="fl">0.477</span>  <span class="dv">1748</span> <span class="fl">0.538</span></span>
<span id="cb13-9"><a href="#cb13-9"></a> <span class="dv">5</span> LeBron James        <span class="dv">2016</span>   <span class="dv">737</span>  <span class="dv">1416</span>    <span class="dv">87</span>   <span class="dv">282</span>   <span class="dv">359</span>   <span class="dv">491</span> <span class="fl">0.520</span> <span class="fl">0.309</span> <span class="fl">0.731</span> <span class="fl">0.551</span>  <span class="dv">1920</span> <span class="fl">0.588</span></span>
<span id="cb13-10"><a href="#cb13-10"></a> <span class="dv">6</span> Damian Lillard      <span class="dv">2016</span>   <span class="dv">618</span>  <span class="dv">1474</span>   <span class="dv">229</span>   <span class="dv">610</span>   <span class="dv">414</span>   <span class="dv">464</span> <span class="fl">0.419</span> <span class="fl">0.375</span> <span class="fl">0.892</span> <span class="fl">0.497</span>  <span class="dv">1879</span> <span class="fl">0.560</span></span>
<span id="cb13-11"><a href="#cb13-11"></a> <span class="dv">7</span> Anthony Davis       <span class="dv">2016</span>   <span class="dv">560</span>  <span class="dv">1137</span>    <span class="dv">35</span>   <span class="dv">108</span>   <span class="dv">326</span>   <span class="dv">430</span> <span class="fl">0.493</span> <span class="fl">0.324</span> <span class="fl">0.758</span> <span class="fl">0.508</span>  <span class="dv">1481</span> <span class="fl">0.558</span></span>
<span id="cb13-12"><a href="#cb13-12"></a> <span class="dv">8</span> Russell Westbrook   <span class="dv">2016</span>   <span class="dv">656</span>  <span class="dv">1444</span>   <span class="dv">101</span>   <span class="dv">341</span>   <span class="dv">465</span>   <span class="dv">573</span> <span class="fl">0.454</span> <span class="fl">0.296</span> <span class="fl">0.812</span> <span class="fl">0.489</span>  <span class="dv">1878</span> <span class="fl">0.554</span></span>
<span id="cb13-13"><a href="#cb13-13"></a> <span class="dv">9</span> DeMar DeRozan       <span class="dv">2016</span>   <span class="dv">614</span>  <span class="dv">1377</span>    <span class="dv">47</span>   <span class="dv">139</span>   <span class="dv">555</span>   <span class="dv">653</span> <span class="fl">0.446</span> <span class="fl">0.338</span> <span class="fl">0.850</span> <span class="fl">0.463</span>  <span class="dv">1830</span> <span class="fl">0.550</span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="dv">10</span> Paul George         <span class="dv">2016</span>   <span class="dv">605</span>  <span class="dv">1448</span>   <span class="dv">210</span>   <span class="dv">565</span>   <span class="dv">454</span>   <span class="dv">528</span> <span class="fl">0.418</span> <span class="fl">0.372</span> <span class="fl">0.860</span> <span class="fl">0.490</span>  <span class="dv">1874</span> <span class="fl">0.558</span></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="co"># … with 4,827 more rows</span></span></code></pre></div>
<p>What if we wanted to pull out the observations corresponding to the 2015-16 and 2014-15 season. We could do something like <code>filter(raw_shooting, (SEASON == 2016) | (SEASON == 2015))</code>, which would be perfectly fine. However, what if we wanted data from 1998-99, 2011-12, and 2015-16? Typing a lot of expressions like <code>SEASON == ...</code> would be rather tedious. The <code>%in%</code> operator lets us avoid this tedium:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">filter</span>(raw_shooting, SEASON <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1999</span>, <span class="dv">2012</span>, <span class="dv">2016</span>))</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co"># A tibble: 1,150 x 14</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>   PLAYER            SEASON   FGM   FGA   TPM   TPA   FTM   FTA   FGP   TPP   FTP  eFGP   PTS   TSP</span>
<span id="cb14-4"><a href="#cb14-4"></a>   <span class="op">&lt;</span>chr<span class="op">&gt;</span><span class="st">              </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="st"> </span><span class="dv">1</span> Stephen Curry       <span class="dv">2016</span>   <span class="dv">805</span>  <span class="dv">1597</span>   <span class="dv">402</span>   <span class="dv">887</span>   <span class="dv">363</span>   <span class="dv">400</span> <span class="fl">0.504</span> <span class="fl">0.453</span> <span class="fl">0.908</span> <span class="fl">0.630</span>  <span class="dv">2375</span> <span class="fl">0.670</span></span>
<span id="cb14-6"><a href="#cb14-6"></a> <span class="dv">2</span> James Harden        <span class="dv">2016</span>   <span class="dv">710</span>  <span class="dv">1617</span>   <span class="dv">236</span>   <span class="dv">657</span>   <span class="dv">720</span>   <span class="dv">837</span> <span class="fl">0.439</span> <span class="fl">0.359</span> <span class="fl">0.860</span> <span class="fl">0.512</span>  <span class="dv">2376</span> <span class="fl">0.598</span></span>
<span id="cb14-7"><a href="#cb14-7"></a> <span class="dv">3</span> Kevin Durant        <span class="dv">2016</span>   <span class="dv">698</span>  <span class="dv">1381</span>   <span class="dv">186</span>   <span class="dv">480</span>   <span class="dv">447</span>   <span class="dv">498</span> <span class="fl">0.505</span> <span class="fl">0.388</span> <span class="fl">0.898</span> <span class="fl">0.573</span>  <span class="dv">2029</span> <span class="fl">0.634</span></span>
<span id="cb14-8"><a href="#cb14-8"></a> <span class="dv">4</span> DeMarcus Cousins    <span class="dv">2016</span>   <span class="dv">601</span>  <span class="dv">1332</span>    <span class="dv">70</span>   <span class="dv">210</span>   <span class="dv">476</span>   <span class="dv">663</span> <span class="fl">0.451</span> <span class="fl">0.333</span> <span class="fl">0.718</span> <span class="fl">0.477</span>  <span class="dv">1748</span> <span class="fl">0.538</span></span>
<span id="cb14-9"><a href="#cb14-9"></a> <span class="dv">5</span> LeBron James        <span class="dv">2016</span>   <span class="dv">737</span>  <span class="dv">1416</span>    <span class="dv">87</span>   <span class="dv">282</span>   <span class="dv">359</span>   <span class="dv">491</span> <span class="fl">0.520</span> <span class="fl">0.309</span> <span class="fl">0.731</span> <span class="fl">0.551</span>  <span class="dv">1920</span> <span class="fl">0.588</span></span>
<span id="cb14-10"><a href="#cb14-10"></a> <span class="dv">6</span> Damian Lillard      <span class="dv">2016</span>   <span class="dv">618</span>  <span class="dv">1474</span>   <span class="dv">229</span>   <span class="dv">610</span>   <span class="dv">414</span>   <span class="dv">464</span> <span class="fl">0.419</span> <span class="fl">0.375</span> <span class="fl">0.892</span> <span class="fl">0.497</span>  <span class="dv">1879</span> <span class="fl">0.560</span></span>
<span id="cb14-11"><a href="#cb14-11"></a> <span class="dv">7</span> Anthony Davis       <span class="dv">2016</span>   <span class="dv">560</span>  <span class="dv">1137</span>    <span class="dv">35</span>   <span class="dv">108</span>   <span class="dv">326</span>   <span class="dv">430</span> <span class="fl">0.493</span> <span class="fl">0.324</span> <span class="fl">0.758</span> <span class="fl">0.508</span>  <span class="dv">1481</span> <span class="fl">0.558</span></span>
<span id="cb14-12"><a href="#cb14-12"></a> <span class="dv">8</span> Russell Westbrook   <span class="dv">2016</span>   <span class="dv">656</span>  <span class="dv">1444</span>   <span class="dv">101</span>   <span class="dv">341</span>   <span class="dv">465</span>   <span class="dv">573</span> <span class="fl">0.454</span> <span class="fl">0.296</span> <span class="fl">0.812</span> <span class="fl">0.489</span>  <span class="dv">1878</span> <span class="fl">0.554</span></span>
<span id="cb14-13"><a href="#cb14-13"></a> <span class="dv">9</span> DeMar DeRozan       <span class="dv">2016</span>   <span class="dv">614</span>  <span class="dv">1377</span>    <span class="dv">47</span>   <span class="dv">139</span>   <span class="dv">555</span>   <span class="dv">653</span> <span class="fl">0.446</span> <span class="fl">0.338</span> <span class="fl">0.850</span> <span class="fl">0.463</span>  <span class="dv">1830</span> <span class="fl">0.550</span></span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="dv">10</span> Paul George         <span class="dv">2016</span>   <span class="dv">605</span>  <span class="dv">1448</span>   <span class="dv">210</span>   <span class="dv">565</span>   <span class="dv">454</span>   <span class="dv">528</span> <span class="fl">0.418</span> <span class="fl">0.372</span> <span class="fl">0.860</span> <span class="fl">0.490</span>  <span class="dv">1874</span> <span class="fl">0.558</span></span>
<span id="cb14-15"><a href="#cb14-15"></a><span class="co"># … with 1,140 more rows</span></span></code></pre></div>
<p>We could also filter out data from the two lockout-shortened seasons, 1998-99 and 2011-12 using a combination of the NOT <code>!</code> operator and <code>%in%</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">filter</span>(raw_shooting, <span class="op">!</span>SEASON <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1999</span>, <span class="dv">2012</span>))</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co"># A tibble: 6,721 x 14</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>   PLAYER            SEASON   FGM   FGA   TPM   TPA   FTM   FTA   FGP   TPP   FTP  eFGP   PTS   TSP</span>
<span id="cb15-4"><a href="#cb15-4"></a>   <span class="op">&lt;</span>chr<span class="op">&gt;</span><span class="st">              </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="st"> </span><span class="dv">1</span> Stephen Curry       <span class="dv">2016</span>   <span class="dv">805</span>  <span class="dv">1597</span>   <span class="dv">402</span>   <span class="dv">887</span>   <span class="dv">363</span>   <span class="dv">400</span> <span class="fl">0.504</span> <span class="fl">0.453</span> <span class="fl">0.908</span> <span class="fl">0.630</span>  <span class="dv">2375</span> <span class="fl">0.670</span></span>
<span id="cb15-6"><a href="#cb15-6"></a> <span class="dv">2</span> James Harden        <span class="dv">2016</span>   <span class="dv">710</span>  <span class="dv">1617</span>   <span class="dv">236</span>   <span class="dv">657</span>   <span class="dv">720</span>   <span class="dv">837</span> <span class="fl">0.439</span> <span class="fl">0.359</span> <span class="fl">0.860</span> <span class="fl">0.512</span>  <span class="dv">2376</span> <span class="fl">0.598</span></span>
<span id="cb15-7"><a href="#cb15-7"></a> <span class="dv">3</span> Kevin Durant        <span class="dv">2016</span>   <span class="dv">698</span>  <span class="dv">1381</span>   <span class="dv">186</span>   <span class="dv">480</span>   <span class="dv">447</span>   <span class="dv">498</span> <span class="fl">0.505</span> <span class="fl">0.388</span> <span class="fl">0.898</span> <span class="fl">0.573</span>  <span class="dv">2029</span> <span class="fl">0.634</span></span>
<span id="cb15-8"><a href="#cb15-8"></a> <span class="dv">4</span> DeMarcus Cousins    <span class="dv">2016</span>   <span class="dv">601</span>  <span class="dv">1332</span>    <span class="dv">70</span>   <span class="dv">210</span>   <span class="dv">476</span>   <span class="dv">663</span> <span class="fl">0.451</span> <span class="fl">0.333</span> <span class="fl">0.718</span> <span class="fl">0.477</span>  <span class="dv">1748</span> <span class="fl">0.538</span></span>
<span id="cb15-9"><a href="#cb15-9"></a> <span class="dv">5</span> LeBron James        <span class="dv">2016</span>   <span class="dv">737</span>  <span class="dv">1416</span>    <span class="dv">87</span>   <span class="dv">282</span>   <span class="dv">359</span>   <span class="dv">491</span> <span class="fl">0.520</span> <span class="fl">0.309</span> <span class="fl">0.731</span> <span class="fl">0.551</span>  <span class="dv">1920</span> <span class="fl">0.588</span></span>
<span id="cb15-10"><a href="#cb15-10"></a> <span class="dv">6</span> Damian Lillard      <span class="dv">2016</span>   <span class="dv">618</span>  <span class="dv">1474</span>   <span class="dv">229</span>   <span class="dv">610</span>   <span class="dv">414</span>   <span class="dv">464</span> <span class="fl">0.419</span> <span class="fl">0.375</span> <span class="fl">0.892</span> <span class="fl">0.497</span>  <span class="dv">1879</span> <span class="fl">0.560</span></span>
<span id="cb15-11"><a href="#cb15-11"></a> <span class="dv">7</span> Anthony Davis       <span class="dv">2016</span>   <span class="dv">560</span>  <span class="dv">1137</span>    <span class="dv">35</span>   <span class="dv">108</span>   <span class="dv">326</span>   <span class="dv">430</span> <span class="fl">0.493</span> <span class="fl">0.324</span> <span class="fl">0.758</span> <span class="fl">0.508</span>  <span class="dv">1481</span> <span class="fl">0.558</span></span>
<span id="cb15-12"><a href="#cb15-12"></a> <span class="dv">8</span> Russell Westbrook   <span class="dv">2016</span>   <span class="dv">656</span>  <span class="dv">1444</span>   <span class="dv">101</span>   <span class="dv">341</span>   <span class="dv">465</span>   <span class="dv">573</span> <span class="fl">0.454</span> <span class="fl">0.296</span> <span class="fl">0.812</span> <span class="fl">0.489</span>  <span class="dv">1878</span> <span class="fl">0.554</span></span>
<span id="cb15-13"><a href="#cb15-13"></a> <span class="dv">9</span> DeMar DeRozan       <span class="dv">2016</span>   <span class="dv">614</span>  <span class="dv">1377</span>    <span class="dv">47</span>   <span class="dv">139</span>   <span class="dv">555</span>   <span class="dv">653</span> <span class="fl">0.446</span> <span class="fl">0.338</span> <span class="fl">0.850</span> <span class="fl">0.463</span>  <span class="dv">1830</span> <span class="fl">0.550</span></span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="dv">10</span> Paul George         <span class="dv">2016</span>   <span class="dv">605</span>  <span class="dv">1448</span>   <span class="dv">210</span>   <span class="dv">565</span>   <span class="dv">454</span>   <span class="dv">528</span> <span class="fl">0.418</span> <span class="fl">0.372</span> <span class="fl">0.860</span> <span class="fl">0.490</span>  <span class="dv">1874</span> <span class="fl">0.558</span></span>
<span id="cb15-15"><a href="#cb15-15"></a><span class="co"># … with 6,711 more rows</span></span></code></pre></div>
<p>For the remainder of this module, we will focus on the players who attempted at least 100 field goals, 100 free throws, 50 three pointers in the non-lockout seasons.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="op">&gt;</span><span class="st"> </span>nba_shooting &lt;-<span class="st"> </span><span class="kw">filter</span>(raw_shooting, (FGA <span class="op">&gt;=</span><span class="st"> </span><span class="dv">100</span> <span class="op">&amp;</span><span class="st"> </span>FTA <span class="op">&gt;=</span><span class="st"> </span><span class="dv">100</span> <span class="op">&amp;</span><span class="st"> </span>TPA <span class="op">&gt;=</span><span class="st"> </span><span class="dv">50</span> <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span>SEASON <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1999</span>, <span class="dv">2012</span>)))</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="op">&gt;</span><span class="st"> </span>nba_shooting</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co"># A tibble: 2,254 x 14</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>   PLAYER            SEASON   FGM   FGA   TPM   TPA   FTM   FTA   FGP   TPP   FTP  eFGP   PTS   TSP</span>
<span id="cb16-5"><a href="#cb16-5"></a>   <span class="op">&lt;</span>chr<span class="op">&gt;</span><span class="st">              </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="st"> </span><span class="dv">1</span> Stephen Curry       <span class="dv">2016</span>   <span class="dv">805</span>  <span class="dv">1597</span>   <span class="dv">402</span>   <span class="dv">887</span>   <span class="dv">363</span>   <span class="dv">400</span> <span class="fl">0.504</span> <span class="fl">0.453</span> <span class="fl">0.908</span> <span class="fl">0.630</span>  <span class="dv">2375</span> <span class="fl">0.670</span></span>
<span id="cb16-7"><a href="#cb16-7"></a> <span class="dv">2</span> James Harden        <span class="dv">2016</span>   <span class="dv">710</span>  <span class="dv">1617</span>   <span class="dv">236</span>   <span class="dv">657</span>   <span class="dv">720</span>   <span class="dv">837</span> <span class="fl">0.439</span> <span class="fl">0.359</span> <span class="fl">0.860</span> <span class="fl">0.512</span>  <span class="dv">2376</span> <span class="fl">0.598</span></span>
<span id="cb16-8"><a href="#cb16-8"></a> <span class="dv">3</span> Kevin Durant        <span class="dv">2016</span>   <span class="dv">698</span>  <span class="dv">1381</span>   <span class="dv">186</span>   <span class="dv">480</span>   <span class="dv">447</span>   <span class="dv">498</span> <span class="fl">0.505</span> <span class="fl">0.388</span> <span class="fl">0.898</span> <span class="fl">0.573</span>  <span class="dv">2029</span> <span class="fl">0.634</span></span>
<span id="cb16-9"><a href="#cb16-9"></a> <span class="dv">4</span> DeMarcus Cousins    <span class="dv">2016</span>   <span class="dv">601</span>  <span class="dv">1332</span>    <span class="dv">70</span>   <span class="dv">210</span>   <span class="dv">476</span>   <span class="dv">663</span> <span class="fl">0.451</span> <span class="fl">0.333</span> <span class="fl">0.718</span> <span class="fl">0.477</span>  <span class="dv">1748</span> <span class="fl">0.538</span></span>
<span id="cb16-10"><a href="#cb16-10"></a> <span class="dv">5</span> LeBron James        <span class="dv">2016</span>   <span class="dv">737</span>  <span class="dv">1416</span>    <span class="dv">87</span>   <span class="dv">282</span>   <span class="dv">359</span>   <span class="dv">491</span> <span class="fl">0.520</span> <span class="fl">0.309</span> <span class="fl">0.731</span> <span class="fl">0.551</span>  <span class="dv">1920</span> <span class="fl">0.588</span></span>
<span id="cb16-11"><a href="#cb16-11"></a> <span class="dv">6</span> Damian Lillard      <span class="dv">2016</span>   <span class="dv">618</span>  <span class="dv">1474</span>   <span class="dv">229</span>   <span class="dv">610</span>   <span class="dv">414</span>   <span class="dv">464</span> <span class="fl">0.419</span> <span class="fl">0.375</span> <span class="fl">0.892</span> <span class="fl">0.497</span>  <span class="dv">1879</span> <span class="fl">0.560</span></span>
<span id="cb16-12"><a href="#cb16-12"></a> <span class="dv">7</span> Anthony Davis       <span class="dv">2016</span>   <span class="dv">560</span>  <span class="dv">1137</span>    <span class="dv">35</span>   <span class="dv">108</span>   <span class="dv">326</span>   <span class="dv">430</span> <span class="fl">0.493</span> <span class="fl">0.324</span> <span class="fl">0.758</span> <span class="fl">0.508</span>  <span class="dv">1481</span> <span class="fl">0.558</span></span>
<span id="cb16-13"><a href="#cb16-13"></a> <span class="dv">8</span> Russell Westbrook   <span class="dv">2016</span>   <span class="dv">656</span>  <span class="dv">1444</span>   <span class="dv">101</span>   <span class="dv">341</span>   <span class="dv">465</span>   <span class="dv">573</span> <span class="fl">0.454</span> <span class="fl">0.296</span> <span class="fl">0.812</span> <span class="fl">0.489</span>  <span class="dv">1878</span> <span class="fl">0.554</span></span>
<span id="cb16-14"><a href="#cb16-14"></a> <span class="dv">9</span> DeMar DeRozan       <span class="dv">2016</span>   <span class="dv">614</span>  <span class="dv">1377</span>    <span class="dv">47</span>   <span class="dv">139</span>   <span class="dv">555</span>   <span class="dv">653</span> <span class="fl">0.446</span> <span class="fl">0.338</span> <span class="fl">0.850</span> <span class="fl">0.463</span>  <span class="dv">1830</span> <span class="fl">0.550</span></span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="dv">10</span> Paul George         <span class="dv">2016</span>   <span class="dv">605</span>  <span class="dv">1448</span>   <span class="dv">210</span>   <span class="dv">565</span>   <span class="dv">454</span>   <span class="dv">528</span> <span class="fl">0.418</span> <span class="fl">0.372</span> <span class="fl">0.860</span> <span class="fl">0.490</span>  <span class="dv">1874</span> <span class="fl">0.558</span></span>
<span id="cb16-16"><a href="#cb16-16"></a><span class="co"># … with 2,244 more rows</span></span></code></pre></div>
</div>
<div id="creating-categorical-variables" class="section level2">
<h2>Creating Categorical Variables</h2>
<p>So far, we have used <code>mutate()</code> to compute numeric or continuous variables. Often in an analysis, however, we may want to <em>bin</em> these values into smaller buckets or categories. For instance, we may rather arbitrarily classify players based on their three-point shooting prowess as follows:</p>
<ul>
<li>Hopeless: TPP &lt; 20%</li>
<li>Below Average: 20% &lt;= TPP &lt; 30%</li>
<li>Average: 30% &lt;= TPP &lt; 35%</li>
<li>Above Average: 35% &lt; TPP &lt; 40%</li>
<li>Elite: TPP &gt; 40%</li>
</ul>
<p>In order to add a column to <code>nba_shooting</code> that includes these classifications, we can use the <code>case_when()</code> function</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="op">&gt;</span><span class="st"> </span>nba_shooting &lt;-<span class="st"> </span><span class="kw">mutate</span>(nba_shooting,</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="op">+</span><span class="st">                        </span><span class="dt">Classification =</span> <span class="kw">case_when</span>(</span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="op">+</span><span class="st">                          </span>TPP <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.2</span> <span class="op">~</span><span class="st">  &quot;Hopeless&quot;</span>,</span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="op">+</span><span class="st">                          </span><span class="fl">0.2</span> <span class="op">&lt;=</span><span class="st"> </span>TPP <span class="op">&amp;</span><span class="st"> </span>TPP <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.3</span> <span class="op">~</span><span class="st"> &quot;Below Average&quot;</span>,</span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="op">+</span><span class="st">                          </span><span class="fl">0.3</span> <span class="op">&lt;=</span><span class="st"> </span>TPP <span class="op">&amp;</span><span class="st"> </span>TPP <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.35</span> <span class="op">~</span><span class="st">  &quot;Average&quot;</span>,</span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="op">+</span><span class="st">                          </span><span class="fl">0.35</span> <span class="op">&lt;=</span><span class="st"> </span>TPP <span class="op">&amp;</span><span class="st"> </span>TPP <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.4</span> <span class="op">~</span><span class="st"> &quot;Above Average&quot;</span>,</span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="op">+</span><span class="st">                          </span><span class="fl">0.4</span> <span class="op">&lt;=</span><span class="st"> </span>TPP <span class="op">~</span><span class="st"> &quot;Elite&quot;</span>))</span></code></pre></div>
<p>Let’s take a minute to unpack the code above. Within <code>mutate()</code>, we have started like we always did, with the name of the new variable on the left hand side of an equal sign. Then we called the <code>case_when()</code> function. Within this function, we have a new line for each of the values of the new variable “Classification”. On each line we have an expression with a twiddle (<code>~</code>). On the left of the <code>~</code>, we have put a logical expression and on the right we have written the value of “Clasification.”</p>
</div>
<div id="summarizing-individual-columns" class="section level2">
<h2>Summarizing Individual Columns</h2>
<p>Among eligible players, what was the average field goal percentage in the 2015-16 season? To answer this, we can use <code>filter()</code> to create a new tbl containing the data only for this season. Then we can use the dplyr verb <code>summarize()</code> as follows:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="op">&gt;</span><span class="st"> </span>nba_shooting_<span class="dv">2016</span> &lt;-<span class="st"> </span><span class="kw">filter</span>(nba_shooting, SEASON <span class="op">==</span><span class="st"> </span><span class="dv">2016</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">summarize</span>(nba_shooting_<span class="dv">2016</span>, <span class="dt">FGP =</span> <span class="kw">mean</span>(FGP))</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co"># A tibble: 1 x 1</span></span>
<span id="cb18-4"><a href="#cb18-4"></a>    FGP</span>
<span id="cb18-5"><a href="#cb18-5"></a>  <span class="op">&lt;</span>dbl<span class="op">&gt;</span></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="dv">1</span> <span class="fl">0.438</span></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">summarize</span>(nba_shooting_<span class="dv">2016</span>, <span class="dt">FGP =</span> <span class="kw">mean</span>(FGP), <span class="dt">TPP =</span> <span class="kw">mean</span>(TPP), <span class="dt">FTP =</span> <span class="kw">mean</span>(FTP))</span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="co"># A tibble: 1 x 3</span></span>
<span id="cb18-9"><a href="#cb18-9"></a>    FGP   TPP   FTP</span>
<span id="cb18-10"><a href="#cb18-10"></a>  <span class="op">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="dv">1</span> <span class="fl">0.438</span> <span class="fl">0.346</span> <span class="fl">0.790</span></span></code></pre></div>
<p>In the first line, we compute the average field goal percentage and in the second example, we compute the average field goal, three point, and free throw percentages. Of course, we are not limited to computing just the mean. The following functions are quite useful for summarizing several aspects of the distribution of the variables in our dataset:</p>
<ul>
<li>Center: <code>mean()</code>, <code>median()</code></li>
<li>Spread: <code>sd()</code>, <code>IQR()</code></li>
<li>Range: <code>min()</code>, <code>max()</code></li>
<li>Count: <code>n()</code>, <code>n_distinct()</code></li>
</ul>
<p>We will have much more to say about <code>summarize()</code> in <a href="lecture3.html">Lecture 3</a> when we discuss grouped manipulations.</p>
<div id="selecting-columns" class="section level3">
<h3>Selecting Columns</h3>
<p>Oftentimes, the dataset you load into R contains many, many more columns than you need. We can use <code>select()</code> to pull out the columns we want to use in our subsequent analyses. For instance, we may want to only focus on the columns SEASON, FGP, TPP, FTP, eFGP, PTS, and TSP and ignore the rest of the columns.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">select</span>(nba_shooting, PLAYER, SEASON, FGP, TPP, FTP, eFGP, PTS, TSP)</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co"># A tibble: 2,254 x 8</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>   PLAYER            SEASON   FGP   TPP   FTP  eFGP   PTS   TSP</span>
<span id="cb19-4"><a href="#cb19-4"></a>   <span class="op">&lt;</span>chr<span class="op">&gt;</span><span class="st">              </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="st"> </span><span class="dv">1</span> Stephen Curry       <span class="dv">2016</span> <span class="fl">0.504</span> <span class="fl">0.453</span> <span class="fl">0.908</span> <span class="fl">0.630</span>  <span class="dv">2375</span> <span class="fl">0.670</span></span>
<span id="cb19-6"><a href="#cb19-6"></a> <span class="dv">2</span> James Harden        <span class="dv">2016</span> <span class="fl">0.439</span> <span class="fl">0.359</span> <span class="fl">0.860</span> <span class="fl">0.512</span>  <span class="dv">2376</span> <span class="fl">0.598</span></span>
<span id="cb19-7"><a href="#cb19-7"></a> <span class="dv">3</span> Kevin Durant        <span class="dv">2016</span> <span class="fl">0.505</span> <span class="fl">0.388</span> <span class="fl">0.898</span> <span class="fl">0.573</span>  <span class="dv">2029</span> <span class="fl">0.634</span></span>
<span id="cb19-8"><a href="#cb19-8"></a> <span class="dv">4</span> DeMarcus Cousins    <span class="dv">2016</span> <span class="fl">0.451</span> <span class="fl">0.333</span> <span class="fl">0.718</span> <span class="fl">0.477</span>  <span class="dv">1748</span> <span class="fl">0.538</span></span>
<span id="cb19-9"><a href="#cb19-9"></a> <span class="dv">5</span> LeBron James        <span class="dv">2016</span> <span class="fl">0.520</span> <span class="fl">0.309</span> <span class="fl">0.731</span> <span class="fl">0.551</span>  <span class="dv">1920</span> <span class="fl">0.588</span></span>
<span id="cb19-10"><a href="#cb19-10"></a> <span class="dv">6</span> Damian Lillard      <span class="dv">2016</span> <span class="fl">0.419</span> <span class="fl">0.375</span> <span class="fl">0.892</span> <span class="fl">0.497</span>  <span class="dv">1879</span> <span class="fl">0.560</span></span>
<span id="cb19-11"><a href="#cb19-11"></a> <span class="dv">7</span> Anthony Davis       <span class="dv">2016</span> <span class="fl">0.493</span> <span class="fl">0.324</span> <span class="fl">0.758</span> <span class="fl">0.508</span>  <span class="dv">1481</span> <span class="fl">0.558</span></span>
<span id="cb19-12"><a href="#cb19-12"></a> <span class="dv">8</span> Russell Westbrook   <span class="dv">2016</span> <span class="fl">0.454</span> <span class="fl">0.296</span> <span class="fl">0.812</span> <span class="fl">0.489</span>  <span class="dv">1878</span> <span class="fl">0.554</span></span>
<span id="cb19-13"><a href="#cb19-13"></a> <span class="dv">9</span> DeMar DeRozan       <span class="dv">2016</span> <span class="fl">0.446</span> <span class="fl">0.338</span> <span class="fl">0.850</span> <span class="fl">0.463</span>  <span class="dv">1830</span> <span class="fl">0.550</span></span>
<span id="cb19-14"><a href="#cb19-14"></a><span class="dv">10</span> Paul George         <span class="dv">2016</span> <span class="fl">0.418</span> <span class="fl">0.372</span> <span class="fl">0.860</span> <span class="fl">0.490</span>  <span class="dv">1874</span> <span class="fl">0.558</span></span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="co"># … with 2,244 more rows</span></span></code></pre></div>
</div>
</div>
<div id="saving-our-work" class="section level2">
<h2>Saving our work</h2>
<p>By this point, the <code>nba_shooting</code> tbl has much more information in it than the original data file we read in. While we can always re-run the commands used to produce this tbl from our script, when data analyses become more complicated, it is helpful to save these objects. R has its own special file format for efficiently saving data on your computer.</p>
<p>We will use the <code>save()</code> command.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">save</span>(nba_shooting, <span class="dt">file =</span> <span class="st">&quot;data/nba_shooting.RData&quot;</span>)</span></code></pre></div>
<p>When we want to <em>load</em> the data back into R, we can use the <code>load()</code> function</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">load</span>(<span class="st">&quot;data/nba_shooting.RData&quot;</span>)</span></code></pre></div>
</div>
<div id="thinking-ahead-for-tomorrow" class="section level2">
<h2>Thinking Ahead for Tomorrow</h2>
<p>Up to this point, we have only used the dplyr verbs <code>mutate()</code>, <code>filter()</code>, and <code>arrange()</code> one at a time. What if we wanted to do something a bit more complicated like:</p>
<ol style="list-style-type: decimal">
<li>Remove players from the lockout season who had fewer than 100 field goal attempts, fewer than 100 free throw attempts, or fewer than 50 three point attempts</li>
<li>Arrange them according to their three point percentage.</li>
<li>Add a classification of their three point shooting ability (as we did above with <code>case_when()</code>)</li>
<li>Compute the mean field goal percentage of all of the players within each of these categories. That is, separately compute the mean field goal percentage of the “Elite” three point shooters, the “Above Average” three point shooters, etc.</li>
</ol>
<p>In <a href="lecture3.html">Lecture 3</a>, we will learn how to string together several dplyr verbs to perform the above tasks. We will also learn how to perform grouped calculations.</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
